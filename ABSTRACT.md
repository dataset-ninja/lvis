In the realm of object detection, the authors of the **LVIS** (Large Vocabulary Instance Segmentation) dataset recognized the pivotal role of datasets in directing the research community's attention to various challenges. This evolution has taken researchers from simple images to complex scenes and from bounding boxes to segmentation masks. The authors' aim is to amass approximately 2 million high-quality instance segmentation masks, encompassing over 1000 entry-level object categories found in 164,000 images. Given the Zipfian distribution of categories in natural images, LVIS inherently exhibits a long tail of categories with limited training samples. As contemporary deep learning techniques for object detection tend to perform inadequately in scenarios with limited training data, the authors view their dataset as an essential and compelling new avenue for scientific exploration.

One of the primary objectives of computer vision is to imbue algorithms with the capability to intelligently describe images. Object detection serves as a fundamental task in image description, as it aligns with intuitive appeal, practical utility, and ease of benchmarking in existing contexts. Noteworthy enhancements have been made in object detector accuracy, alongside the development of novel capabilities like predicting segmentation masks and 3D representations. This progression opens up exciting possibilities to extend these methods toward new objectives. Presently, the rigorous evaluation of general-purpose object detectors primarily takes place within a limited category regime (e.g., 80 categories) or when a substantial number of training examples are available for each category (e.g., 100 to 1000+). Consequently, there is an opportunity to foster research in a more natural setting where numerous categories coexist, and data per category may be sparse. The presence of a long tail of rare categories is inescapable, and the act of annotating additional images often uncovers previously unseen, rare categories.

Efficiently learning from a minimal number of examples presents a significant open challenge in the realms of machine learning and computer vision. The authors regard this opportunity as one of the most thrilling, both from a scientific and practical perspective. However, to delve into this area empirically, the authors recognized the necessity for an appropriate, high-quality dataset and benchmark.

To facilitate this novel research direction, the authors designed and curated LVIS, a benchmark dataset dedicated to research in Large Vocabulary Instance Segmentation. The authors' annotation process commences from a collection of images obtained without prior knowledge of the categories to be labeled within them. They engage annotators in an iterative process of object spotting, uncovering the long tail of categories that naturally emerge in the images while <i>avoiding the use of machine learning algorithms</i> for automated data labeling.

The authors made a significant observation that the desired evaluation protocol did not mandate exhaustive annotation of all images with all categories. Instead, the key requirement was the existence of two distinct subsets, the Positive set (Pc) and the Negative set (Nc), for each category. The Positive set consists of images in which all instances of category are segmented exhaustively, while the Negative set contains images where no instance of category is present. These subsets enable standard COCO-style AP evaluation for each category. Crucially, the evaluation oracle assesses the algorithm's performance for a given category only on the subset of images where category has been exhaustively annotated. If a detector reports a detection of category on an image outside of this subset, the detection remains unevaluated. By consolidating these per-category sets into a single dataset, the authors introduced the concept of a federated dataset. A federated dataset is an amalgamation of smaller constituent datasets, each resembling a traditional object detection dataset for a single category. The freedom to avoid annotating all images with all categories while maintaining ample inter-annotator agreement reduced ambiguity in the annotation process and significantly reduced the workload.

<img src="https://github.com/dataset-ninja/gland-segmentation/assets/78355358/78bef88d-2699-48bf-960c-7653c705463d" alt="image" width="800">

<span style="font-size: smaller; font-style: italic;">Category relationships from left to right: non-disjoint category pairs may be in partially overlapping, parent-child, or equivalent (synonym) relationships, implying that a single object may have multiple valid labels. The fair evaluation of an object detector must take the issue of multiple valid labels into account.</span>

Furthermore, the authors emphasized that membership in the Positive and Negative sets for the test split remained undisclosed. Algorithms had no prior knowledge of which categories would be evaluated in each image. Consequently, an algorithm was required to make predictions for all categories in each test image.

## Annotation Pipeline

<img src="https://github.com/dataset-ninja/gland-segmentation/assets/78355358/ac1eb216-15c0-43d3-a574-22d00ccdd558" alt="image" width="800">

1. **Object Spotting, Stage 1:** In this initial stage, the goals are to generate the Positive set (Pc) for each category in the vocabulary and elicit vocabulary recall by including various object categories in the dataset. Object spotting is an iterative process where each image is visited multiple times. Annotators mark one object with a point and assign it a category from the vocabulary. Subsequent visits involve marking unmarked objects of previously unmarked categories. If an image is skipped three times, it is no longer visited.

2. **Exhaustive Instance Marking, Stage 2:** The objectives of this stage are to verify annotations from Stage 1 and mark all instances of category c in images belonging to Pc. Each pair (i, c) from Stage 1 is sent to five annotators for verification. Annotators mark all instances of the same category if the label matches. Frequent categories are subsampled to avoid dominance.

3. **Instance Segmentation, Stage 3:** In this stage, the focus is on verifying category labels from Stage 2 and upgrading point annotations to full segmentation masks. An annotator is tasked with verifying the category label and, if correct, drawing a detailed segmentation mask for the marked object instance.

4. **Segment Verification, Stage 4:** The primary goal of this stage is to verify the quality of segmentation masks from Stage 3. Annotators rate the quality of each segmentation mask, with a mask accepted only if four annotators agree it is high-quality.

5. **Full Recall Verification, Stage 5:** This stage completes the Positive sets. Annotators are asked if there are any unsegmented instances of category c in images belonging to Pc. An image is considered exhaustive only if at least four annotators agree; otherwise, the exhaustive annotation flag is marked as false.

6. **Negative Sets, Stage 6:** In the final stage, the authors collect Negative sets (Nc) for each category c by randomly sampling images from D that do not belong to Pc. Images where any annotator reports the presence of category c are rejected, while the rest are added to Nc.

The output of these stages yields a comprehensive dataset with Positive and Negative sets for each category, along with high-quality segmentation masks.

## Vocabulary Construction
The authors constructed the vocabulary (V) using an iterative process. They began with a large super-vocabulary of 8.8k synsets from WordNet, selected based on concrete common nouns. Subsequently, they applied object spotting to 10k COCO images, using the super-vocabulary for autocomplete. This iterative process was repeated, resulting in a final vocabulary containing 1723 synsets.

